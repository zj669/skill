# Phase 1.5: å‰§æƒ…ç¼–æŽ’åè®® (Plot Architect Protocol)

## ðŸ“Œ ç›®æ ‡
å°†é™æ€ä¸–ç•Œè§‚è½¬åŒ–ä¸ºåŠ¨æ€çš„ **äº‹ä»¶é“¾**ï¼Œç”Ÿæˆç»“æž„åŒ–çš„ç« èŠ‚ç»†çº²ã€‚

---

## ðŸŽ­ Sub-Skill: Plot_Architect

**è§’è‰²å®šä½**: ä½ æ˜¯å‰§æƒ…è®¾è®¡å¸ˆï¼Œè´Ÿè´£è§„åˆ’"æŽ¥ä¸‹æ¥å‘ç”Ÿä»€ä¹ˆ"ã€‚

**æ ¸å¿ƒèŒè´£**:
1. åˆ†æžå½“å‰å™äº‹çŠ¶æ€ï¼ˆçˆ½ç‚¹æ›²çº¿ã€æ‚¬å¿µåˆ—è¡¨ï¼‰
2. è®¾è®¡æœ¬ç« çš„æ ¸å¿ƒå†²çªä¸Žé«˜æ½®
3. è¾“å‡ºç»“æž„åŒ–ç»†çº²ä¾› Scene_Writer æ‰§è¡Œ

---

## ðŸ›  æ‰§è¡Œæ­¥éª¤

### Step 1: ä¸Šä¸‹æ–‡ä¸€æ¬¡æ€§åŠ è½½

> [!CAUTION]
> ðŸ”§ **MUST_EXECUTE** - ä½ å¿…é¡»å®žé™…æ‰§è¡Œæ­¤è„šæœ¬ï¼Œä¸å¾—è·³è¿‡ï¼

**æ‰§è¡Œå‘½ä»¤**:
```bash
python scripts/context_loader.py --mode planning --chapter {n}
```

**âœ… æ‰§è¡Œæ£€æŸ¥ç‚¹** - ä½ å¿…é¡»æŠ¥å‘Š:
```
ðŸ”§ æ‰§è¡Œå‘½ä»¤: python scripts/context_loader.py --mode planning --chapter {n}
ðŸ“Š è¿”å›žçŠ¶æ€: SUCCESS / ERROR
ðŸ“‹ å…³é”®æ•°æ®: 
   - ä¸Šç« æ‘˜è¦: "...å‰30å­—..."
   - æƒ…ç»ªæ›²çº¿: [...]
   - æ´»è·ƒé’©å­: [...]
```

**è¿”å›žå†…å®¹**:
```json
{
  "chapter": 16,
  "status": "SUCCESS",
  "data": {
    "last_summary": "å¶å‡¡åœ¨æ‹å–ä¼šä¸Šç”¨500çµçŸ³æ‹å¾—æ®‹ç ´åŠŸæ³•...",
    "emo_curve": [10, -5, -20, 15, -10],
    "hooks": ["æˆ’æŒ‡é‡Œçš„è€çˆ·çˆ·", "çŽ‹å®¶è¿½æ€ä»¤"],
    "protagonist": {"name": "å¶å‡¡", "level": "ç»ƒæ°”ä¸‰å±‚", ...},
    "volume_plan": {"volume": 1, "target": "ä¸»è§’ç­‘åŸº", ...}
  }
}
```

**æƒ…ç»ªæ›²çº¿åˆ†æž** (åŸºäºŽ `emo_curve`):
- æœ«å°¾è¿žç»­è´Ÿå€¼ â†’ æœ¬ç« å¿…é¡»å®‰æŽ’ "çˆ†å‘/æ‰“è„¸" å‰§æƒ…
- æœ«å°¾é«˜å€¼ â†’ å¯ä»¥å®‰æŽ’ "ä½Žè°·/è“„åŠ›" å‰§æƒ…

---

### Step 2: æ‚¬å¿µå›žæ”¶æ£€æŸ¥

**è§„åˆ™**: æ¯ 5 ç« å¿…é¡»å›žæ”¶è‡³å°‘ 1 ä¸ªæ‚¬å¿µï¼ˆä»Ž hooks åˆ—è¡¨ä¸­é€‰æ‹©ï¼‰ã€‚

**æ‚¬å¿µå›žæ”¶ç­–ç•¥**:
| æ‚¬å¿µç±»åž‹ | å›žæ”¶æ–¹å¼ | ç¤ºä¾‹ |
|---------|---------|------|
| äººç‰©åž‹ | è¯¥äººç‰©ç™»åœºå¹¶æŽ¨åŠ¨å‰§æƒ… | æˆ’æŒ‡è€çˆ·çˆ·è‹é†’ |
| ç‰©å“åž‹ | ç‰©å“ä½œç”¨æ˜¾çŽ° | æ®‹å›¾æŒ‡å‘å¤æˆ˜åœºä½ç½® |
| äº‹ä»¶åž‹ | å€’è®¡æ—¶å½’é›¶è§¦å‘ | è¡€ç¥­ä»ªå¼å¼€å§‹ |

---

### Step 2.5: èŠ‚æ‹è¡¨å­—æ•°é¢„ç®— (Beat Sheet Budget) ðŸŽ¯ CRITICAL

**æ ¸å¿ƒè§„åˆ™**: æ¯ç« å›ºå®š **3500å­— Â±300**ï¼Œé€šè¿‡èŠ‚æ‹è¡¨æ‹†åˆ†å®žçŽ°ç²¾ç¡®æŽ§åˆ¶ã€‚

**æ ‡å‡†èŠ‚æ‹è¡¨ç»“æž„**:
| åºå· | èŠ‚æ‹åç§° | å­—æ•°é¢„ç®— | åŠŸèƒ½å®šä½ |
|------|----------|----------|----------|
| 1 | ðŸ”— æ‰¿æŽ¥å®šä½ | 300å­— | å»¶ç»­ä¸Šç« å°¾å£°ï¼Œäº¤ä»£æ—¶ç©ºçŠ¶æ€ |
| 2 | ðŸŒ± æ—¥å¸¸/é“ºåž« | 400å­— | å±•ç¤ºè§’è‰²çŠ¶æ€ï¼ŒåŸ‹è®¾ä¼ç¬” |
| 3 | âš¡ è§¦å‘äº‹ä»¶ | 500å­— | æ‰“ç ´å¹³è¡¡çš„äº‹ä»¶å‘ç”Ÿ |
| 4 | ðŸ”¥ æ ¸å¿ƒå†²çª | 800å­— | æœ¬ç« ä¸»è¦çŸ›ç›¾å±•å¼€ä¸Žå¯¹æŠ— |
| 5 | ðŸ’¥ é«˜æ½®çˆ½ç‚¹ | 1000å­— | æƒ…ç»ªçˆ†å‘ç‚¹(æ‰“è„¸/å‡çº§/èŽ·å®ç­‰) |
| 6 | ðŸª æ”¶å°¾+é’©å­ | 500å­— | çŸ­æš‚å¹³æ¯ + æŠ›å‡ºæ–°æ‚¬å¿µ |

**è¾“å‡ºæ ¼å¼ (å¿…é¡»åŒ…å«å­—æ•°é¢„ç®—)**:
```markdown
### èŠ‚æ‹è¡¨
| èŠ‚æ‹ | é¢„ç®— | å†…å®¹ |
|------|------|------|
| æ‰¿æŽ¥å®šä½ | 300å­— | {å…·ä½“åœºæ™¯æè¿°} |
| æ—¥å¸¸é“ºåž« | 400å­— | {å…·ä½“åœºæ™¯æè¿°} |
| è§¦å‘äº‹ä»¶ | 500å­— | {å…·ä½“åœºæ™¯æè¿°} |
| æ ¸å¿ƒå†²çª | 800å­— | {å…·ä½“åœºæ™¯æè¿°} |
| é«˜æ½®çˆ½ç‚¹ | 1000å­— | {å…·ä½“åœºæ™¯æè¿°} |
| æ”¶å°¾é’©å­ | 500å­— | {å…·ä½“åœºæ™¯æè¿°} |

**æœ¬ç« æ€»é¢„ç®—**: 3500å­—
```

**å­—æ•°æ ¡éªŒè§„åˆ™**:
- å•ä¸ªèŠ‚æ‹å…è®¸ Â±20% æ³¢åŠ¨
- å…¨ç« æ€»å­—æ•°å¿…é¡»åœ¨ 3200-3800 èŒƒå›´å†…
- è‹¥è¶…å‡ºèŒƒå›´ï¼Œéœ€é‡æ–°åˆ†é…èŠ‚æ‹å­—æ•°

---

### Step 3: ç»†çº²ç”Ÿæˆ

**è¾“å‡ºæ ¼å¼ (å¿…é¡»)**:
```markdown
## ç¬¬ {chapter_num} ç« ï¼š{chapter_title}

### æ ¸å¿ƒå†²çª
{ä¸»è¦çŸ›ç›¾/å¯¹æŠ—æè¿°ï¼Œ50å­—ä»¥å†…}

### åœºæ™¯åˆ—è¡¨
1. **{åœºæ™¯1åç§°}**: {ç®€è¿°ï¼Œæ¶‰åŠè§’è‰²}
2. **{åœºæ™¯2åç§°}**: {ç®€è¿°ï¼Œæ¶‰åŠè§’è‰²}
3. ...

### é¢„æœŸçˆ½ç‚¹
- ç±»åž‹: {æ‰“è„¸/å‡çº§/èŽ·å®/å¤ä»‡}
- å¼ºåº¦: {HIGH/MID/LOW}
- è§¦å‘æ¡ä»¶: {æè¿°}

### æ¶‰åŠç‰©å“
- ä½¿ç”¨: [{ç‰©å“1}, {ç‰©å“2}]
- èŽ·å¾—: [{æ–°ç‰©å“}]
- æ¶ˆè€—: [{æ¶ˆè€—å“}]

### çŠ¶æ€å˜æ›´é¢„æœŸ
{
  "level_change": "+1 (ç»ƒæ°”ä¸‰å±‚â†’å››å±‚)",
  "items_add": ["é’é”‹å‰‘"],
  "items_remove": ["ç­‘åŸºä¸¹"],
  "relation_change": {"çŽ‹å®¶": "HOSTILE"}
}

### æ‚¬å¿µæ“ä½œ
- å›žæ”¶: ["æˆ’æŒ‡è€çˆ·çˆ·"]
- æ–°å¢ž: ["ç¥žç§˜å‰‘ä¸»èº«ä»½"]
```

---

### Step 4: é¢„æ£€éªŒè¯

**è°ƒç”¨è„šæœ¬æ£€æŸ¥ç‰©å“å¯ç”¨æ€§**:
```bash
python scripts/state_manager.py --action preflight --scene_plan "{outline_json}"
```

* âœ… é€šè¿‡ â†’ è¾“å‡ºç»†çº²
* ðŸ›‘ å¤±è´¥ â†’ ä¿®æ”¹ç»†çº²ä¸­çš„ç‰©å“/æŠ€èƒ½ä½¿ç”¨

---

## ðŸ“„ äº¤ä»˜ç‰©

| è¾“å‡º | ç±»åž‹ | ç”¨é€” |
|------|------|------|
| `chapter_outline.md` | Markdown | æœ¬ç« ç»†çº² |
| `state_delta_preview` | JSON | é¢„æœŸçŠ¶æ€å˜æ›´ (ä¾› Data_Manager å‚è€ƒ) |

## ðŸ›‘ Stop Point / ðŸ”„ Auto-Pilot

**Logic**:
1. **Check Auto-Mode**:
   - If `context.auto_mode` is **True**:
     > ðŸ”§ **MUST_EXECUTE**
     > ```bash
     > python scripts/state_manager.py --action update_step --status NEED_DRAFT
     > ```
     > "ðŸ”„ Auto-mode: Chapter outline ready. Proceeding to DRAFT..."
   - Else:
     > "Chapter outline ready. Please review `chapter_outline.md`.
     > Input 'Approve' to start drafting."
